FROM node:18-alpine
WORKDIR /app

# Install dependencies
ADD ./package.json ./yarn.lock ./
RUN yarn

# Copy source code
COPY ./app ./

# Pass required credentials
ENV GOOGLE_APPLICATION_CREDENTIALS="/run/secrets/google-cloud-auth/key"

# Run
ENTRYPOINT ["node", "database.js"]